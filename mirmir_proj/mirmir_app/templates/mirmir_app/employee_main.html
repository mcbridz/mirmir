{%extends 'mirmir_app/employee_base.html'%}
{%block title%}Mirmir: Employee{%endblock%}
{%block style%}
<style>
    a>i:hover {
        cursor: pointer;
    }
</style>
{%endblock%}
{%block body%}
<h1>This is the Employee Main Page</h1>
<h3>Here will be a list of open orders, followed by a list of active products</h3>
<div class="container" id="app">
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Date Of Order</th>
                <th scope="col">Last Name</th>
                <th scope="col">Total</th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            <tr v-for="(order, index) in open_orders">
                <td>[[order.order_number]]</td>
                <td>[[order.order_date]]</td>
                <td>[[order.billing_last_name]]</td>
                <td>$[[order.total]]</td>
                <td><a @click="loadModal(index)" data-toggle="modal" data-target="#modal"><i
                            class="fas fa-ellipsis-h"></i></a></td>
            </tr>
        </tbody>
    </table>
    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalLabel">Order</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="contact">Contact</label>
                            <input type="text" class="form-control" id="contact" v-model="order_modal_data.contact"
                                disabled>
                        </div>
                        <div class="form-group">
                            <label for="order_number">Order Number</label>
                            <input type="number" class="form-control" id="order_number"
                                v-model="order_modal_data.order_number" disabled>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="order_type">Order Type</label>
                            </div>
                            <select v-model="order_modal_data.order_type" name="order_type" id="order_type"
                                class="custom-select">
                                <option value=1>Admin Panel</option>
                                <option value=2>Club Order</option>
                                <option value=3>Facebook</option>
                                <option value=4>iPad</option>
                                <option value=5>Mobile</option>
                                <option value=6>POS</option>
                                <option value=7>Telemarketing</option>
                                <option value=8>Website</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="order_date">Order Date</label>
                            <input type="text" class="form-control" id="order_date"
                                v-model="order_modal_data.order_date" disabled>
                        </div>
                        <h5>Billing Info</h5>
                        <div class="form-group">
                            <label for="first_name">First Name</label>
                            <input type="text" class="form-control" id="first_name"
                                v-model="order_modal_data.billing_first_name">
                        </div>
                        <div class="form-group">
                            <label for="last_name">Last Name</label>
                            <input type="text" class="form-control" id="last_name"
                                v-model="order_modal_data.billing_last_name">
                        </div>

                        <div class="form-group">
                            <label for="billing_company">Company</label>
                            <input type="text" class="form-control" id="billing_company"
                                v-model="order_modal_data.billing_company">
                        </div>
                        <div class="form-group">
                            <label for="billing_address">Address Line 1</label>
                            <input type="text" class="form-control" id="billing_address"
                                v-model="order_modal_data.billing_address">
                        </div>
                        <div class="form-group">
                            <label for="billing_address2">Address Line 2</label>
                            <input type="text" class="form-control" id="billing_address2"
                                v-model="order_modal_data.billing_address2">
                        </div>
                        <div class="form-group">
                            <label for="billing_city">City</label>
                            <input type="text" class="form-control" id="billing_city"
                                v-model="order_modal_data.billing_city">
                        </div>
                        <div class="form-group">
                            <label for="billing_state_code">State</label>
                            <input type="text" class="form-control" id="billing_state_code"
                                v-model="order_modal_data.billing_state_code">
                        </div>
                        <div class="form-group">
                            <label for="billing_zip_code">Zip Code</label>
                            <input type="number" class="form-control" id="billing_zip_code"
                                v-model="order_modal_data.billing_zip_code">
                        </div>

                        <div v-show="order_modal_data.billing_address != order_modal_data.shipping_address">
                            <h5>Shipping Info</h5>
                            <div class="form-group">
                                <label for="first_name">First Name</label>
                                <input type="text" class="form-control" id="first_name"
                                    v-model="order_modal_data.shipping_first_name">
                            </div>
                            <div class="form-group">
                                <label for="last_name">Last Name</label>
                                <input type="text" class="form-control" id="last_name"
                                    v-model="order_modal_data.shipping_last_name">
                            </div>

                            <div class="form-group">
                                <label for="shipping_company">Company</label>
                                <input type="text" class="form-control" id="shipping_company"
                                    v-model="order_modal_data.shipping_company">
                            </div>
                            <div class="form-group">
                                <label for="shipping_address">Address Line 1</label>
                                <input type="text" class="form-control" id="shipping_address"
                                    v-model="order_modal_data.shipping_address">
                            </div>
                            <div class="form-group">
                                <label for="shipping_address2">Address Line 2</label>
                                <input type="text" class="form-control" id="shipping_address2"
                                    v-model="order_modal_data.shipping_address2">
                            </div>
                            <div class="form-group">
                                <label for="shipping_city">City</label>
                                <input type="text" class="form-control" id="shipping_city"
                                    v-model="order_modal_data.shipping_city">
                            </div>
                            <div class="form-group">
                                <label for="shipping_state_code">State</label>
                                <input type="text" class="form-control" id="shipping_state_code"
                                    v-model="order_modal_data.shipping_state_code">
                            </div>
                            <div class="form-group">
                                <label for="shipping_zip_code">Zip Code</label>
                                <input type="number" class="form-control" id="shipping_zip_code"
                                    v-model="order_modal_data.shipping_zip_code">
                            </div>
                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
</div>

{%endblock%}

{%block javascript%}
<script>
    let app = new Vue({
        el: '#app',
        delimiters: ['[[', ']]'],
        data: {
            message: 'Hello, world!',
            open_orders: [],
            order_modal_data: {
                contact: '',
                order_type: '',
                order_number: '',
                order_date: '',
                billing_birthdate: '',
                billing_first_name: '',
                billing_last_name: '',
                billing_company: '',
                billing_address: '',
                billing_address2: '',
                billing_city: '',
                billing_state_code: '',
                billing_zip_code: '',
                billing_email: '',
                shipping_birthdate: '',
                shipping_first_name: '',
                shipping_last_name: '',
                shipping_company: '',
                shipping_address: '',
                shipping_address2: '',
                shipping_city: '',
                shipping_state_code: '',
                shipping_zip_code: '',
                gift_message: '',
                sub_total: '',
                order_notes: '',
                handling: '',
                shipping: '',
                tax: '',
                total: '',
                previous_order_number: '',
                transaction_type: '',
                is_pickup: '',
                is_paid: '',
                shipping_service: '',
                shipping_tracking_number: '',
                payment_status: '',
                shipping_status: '',
            }
        },
        methods: {
            loadModal: function (i) {
                this.order_modal_data = this.open_orders[i]
            },
            getOpenOrders: function () {
                axios({
                    url: "{% url 'mirmir_app:get_open_orders' %}",
                    method: 'GET',
                }).then(response => {
                    console.log(response.data)
                    this.open_orders = response.data.data
                })
            }
        },
        created: function () {
            this.getOpenOrders()
            this.$forceUpdate()
        }
    })
</script>
{%endblock%}